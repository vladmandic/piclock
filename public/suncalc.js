!function(){"use strict";var n=Math.PI,t=Math.sin,e=Math.cos,r=Math.tan,a=Math.asin,u=Math.atan2,o=Math.acos,i=n/180;function c(n){return new Date(864e5*(n+.5-2440588))}function d(n){return function(n){return n.valueOf()/864e5-.5+2440588}(n)-2451545}var s=23.4397*i;function f(n,a){return u(t(n)*e(s)-r(a)*t(s),e(n))}function l(n,r){return a(t(r)*e(s)+e(r)*t(s)*t(n))}function h(n,a,o){return u(t(n),e(n)*t(a)-r(o)*e(a))}function M(n,r,u){return a(t(r)*t(u)+e(r)*e(u)*e(n))}function g(n,t){return i*(280.16+360.9856235*n)-t}function v(n){return i*(357.5291+.98560028*n)}function w(e){return e+i*(1.9148*t(e)+.02*t(2*e)+3e-4*t(3*e))+102.9372*i+n}function m(n){var t=w(v(n));return{dec:l(t,0),ra:f(t,0)}}var p={getPosition:function(n,t,e){var r=i*-e,a=i*t,u=d(n),o=m(u),c=g(u,r)-o.ra;return{azimuth:h(c,a,o.dec),altitude:M(c,a,o.dec)}}},D=p.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];p.addTime=function(n,t,e){D.push([n,t,e])};function P(t,e,r){return 9e-4+(t+e)/(2*n)+r}function y(n,e,r){return 2451545+n+.0053*t(e)-.0069*t(2*r)}function b(n,r,a,u,i,c,d){return y(P(function(n,r,a){return o((t(n)-t(r)*t(a))/(e(r)*e(a)))}(n,a,u),r,i),c,d)}function H(n){var r=i*(134.963+13.064993*n),a=i*(93.272+13.22935*n),u=i*(218.316+13.176396*n)+6.289*i*t(r),o=5.128*i*t(a),c=385001-20905*e(r);return{ra:f(u,o),dec:l(u,o),dist:c}}function T(n,t){return new Date(n.valueOf()+864e5*t/24)}p.getTimes=function(t,e,r){var a,u,o,s,f,h=i*-r,M=i*e,g=function(t,e){return Math.round(t-9e-4-e/(2*n))}(d(t),h),m=P(0,h,g),p=v(m),H=w(p),T=l(H,0),E=y(m,p,H),I={solarNoon:c(E),nadir:c(E-.5)};for(a=0,u=D.length;a<u;a+=1)f=E-((s=b((o=D[a])[0]*i,h,M,T,g,p,H))-E),I[o[1]]=c(f),I[o[2]]=c(s);return I},p.getMoonPosition=function(n,a,o){var c=i*-o,s=i*a,f=d(n),l=H(f),v=g(f,c)-l.ra,w=M(v,s,l.dec),m=u(t(v),r(s)*e(l.dec)-t(l.dec)*e(v));return w+=function(n){return n<0&&(n=0),2967e-7/Math.tan(n+.00312536/(n+.08901179))}(w),{azimuth:h(v,s,l.dec),altitude:w,distance:l.dist,parallacticAngle:m}},p.getMoonIllumination=function(n){var r=d(n||new Date),a=m(r),i=H(r),c=o(t(a.dec)*t(i.dec)+e(a.dec)*e(i.dec)*e(a.ra-i.ra)),s=u(149598e3*t(c),i.dist-149598e3*e(c)),f=u(e(a.dec)*t(a.ra-i.ra),t(a.dec)*e(i.dec)-e(a.dec)*t(i.dec)*e(a.ra-i.ra));return{fraction:(1+e(s))/2,phase:.5+.5*s*(f<0?-1:1)/Math.PI,angle:f}},p.getMoonTimes=function(n,t,e,r){var a=new Date(n);r?a.setUTCHours(0,0,0,0):a.setHours(0,0,0,0);for(var u,o,c,d,s,f,l,h,M,g,v,w,m,D=.133*i,P=p.getMoonPosition(a,t,e).altitude-D,y=1;y<=24&&(u=p.getMoonPosition(T(a,y),t,e).altitude-D,h=((s=(P+(o=p.getMoonPosition(T(a,y+1),t,e).altitude-D))/2-u)*(l=-(f=(o-P)/2)/(2*s))+f)*l+u,g=0,(M=f*f-4*s*u)>=0&&(v=l-(m=Math.sqrt(M)/(2*Math.abs(s))),w=l+m,Math.abs(v)<=1&&g++,Math.abs(w)<=1&&g++,v<-1&&(v=w)),1===g?P<0?c=y+v:d=y+v:2===g&&(c=y+(h<0?w:v),d=y+(h<0?v:w)),!c||!d);y+=2)P=o;var b={};return c&&(b.rise=T(a,c)),d&&(b.set=T(a,d)),c||d||(b[h>0?"alwaysUp":"alwaysDown"]=!0),b},"object"==typeof exports&&"undefined"!=typeof module?module.exports=p:"function"==typeof define&&define.amd?define(p):window.SunCalc=p}();
